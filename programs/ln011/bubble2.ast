-- the bubble sort

function inorder 
  with [] do
    true
  with [_] do
    true
  with [a|b|rest] do
    order([b]+rest) if a < b else false
end

function bubblesort 
  with [] do
    []
  with [a] do
    [a]
  with [a|b|rest] do
    let t = [b]+bubblesort([a]+rest) if a > b else [a]+bubblesort([b]+rest).
    return bubblesort(t) if not inorder t else t.
end

let k = [6,5,3,1,8,7,2,4].
assert (bubblesort k == [1,2,3,4,5,6,7,8])
